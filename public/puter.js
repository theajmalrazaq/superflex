


(()=>{"use strict";var e={429:(e,t,s)=>{const r=s(614);function n(e,t){const s=e.toLowerCase(),r=t.toLowerCase();if(""===r)return!1;if(-1===r.indexOf("*")&&-1===r.indexOf("?")&&-1===r.indexOf("[")&&-1===r.indexOf("{"))return s===r;let i=r;const o=i.match(/\{([^}]+)\}/);if(o)return o[1].split(",").map(e=>i.replace(o[0],e.trim())).some(t=>n(e,t));let a="",c=0;for(;c<i.length;){const e=i[c];if("*"===e)a+=".*";else if("?"===e)a+=".";else if("["===e){let e=c+1,t="[";for(;e<i.length&&"]"!==i[e];)t+=i[e],e++;e<i.length?(t+="]",a+=t,c=e):a+="\\["}else/[.+^${}()|\\]/.test(e)?a+="\\"+e:a+=e;c++}try{return new RegExp("^"+a+"$","i").test(e)}catch(e){return s===r}}e.exports=class{constructor(e={}){"string"==typeof e&&(e={dbName:e}),this.store=new r,this.expireTimes=new r,this.db=null,this.dbName=e.dbName,this.dbVersion=e.dbVersion||1,this.isIndexedDBAvailable=!1,this.isInitialized=!1,this.initPromise=null,this.storeSet=(e,t)=>{this.store.set(e,t),this._initCleanupLoop(20),this.isIndexedDBAvailable&&this.db&&this._persistToIndexedDB(e,t)},this._initIndexedDB()}_initIndexedDB(){"undefined"!=typeof window&&window.indexedDB&&this.dbName?(this.isIndexedDBAvailable=!0,this.initPromise=this._setupIndexedDB()):this.isInitialized=!0}async _setupIndexedDB(){try{this.db=await this._openDatabase(),await this._loadFromIndexedDB(),this.isInitialized=!0}catch(e){console.warn("Failed to initialize IndexedDB:",e),this.isIndexedDBAvailable=!1,this.isInitialized=!0}}_openDatabase(){return new Promise((e,t)=>{const s=indexedDB.open(this.dbName,this.dbVersion);s.onerror=()=>t(s.error),s.onsuccess=()=>e(s.result),s.onupgradeneeded=e=>{const t=e.target.result;t.objectStoreNames.contains("store")||t.createObjectStore("store",{keyPath:"key"}),t.objectStoreNames.contains("expireTimes")||t.createObjectStore("expireTimes",{keyPath:"key"})}})}async _loadFromIndexedDB(){if(this.db)try{const e=this.db.transaction(["store","expireTimes"],"readonly"),t=e.objectStore("store"),s=e.objectStore("expireTimes"),r=t.getAll(),n=s.getAll(),[i,o]=await Promise.all([new Promise((e,t)=>{r.onsuccess=()=>e(r.result),r.onerror=()=>t(r.error)}),new Promise((e,t)=>{n.onsuccess=()=>e(n.result),n.onerror=()=>t(n.error)})]);i.forEach(e=>{this.store.set(e.key,e.value)}),o.forEach(e=>{this.expireTimes.set(e.key,e.expireTime)});const a=Date.now();for(const[e,t]of this.expireTimes.entries())a>t&&(this.store.delete(e),this.expireTimes.delete(e),this._removeFromIndexedDB(e))}catch(e){console.warn("Failed to load data from IndexedDB:",e)}}async _persistToIndexedDB(e,t){if(this.db)try{this.db.transaction(["store"],"readwrite").objectStore("store").put({key:e,value:t})}catch(e){console.warn("Failed to persist to IndexedDB:",e)}}async _persistExpirationToIndexedDB(e,t){if(this.db)try{const s=this.db.transaction(["expireTimes"],"readwrite").objectStore("expireTimes");void 0!==t?s.put({key:e,expireTime:t}):s.delete(e)}catch(e){console.warn("Failed to persist expiration to IndexedDB:",e)}}async _removeFromIndexedDB(e){if(this.db)try{const t=this.db.transaction(["store","expireTimes"],"readwrite"),s=t.objectStore("store"),r=t.objectStore("expireTimes");s.delete(e),r.delete(e)}catch(e){console.warn("Failed to remove from IndexedDB:",e)}}async waitForInitialization(){this.isInitialized||this.initPromise&&await this.initPromise}set(e,t,s={}){const{NX:r=!1,XX:n=!1,GET:i=!1,EX:o,PX:a,EXAT:c,PXAT:l,KEEPTTL:h=!1}=s,u=r,p=n,d=i;let g=o?parseInt(o,10):void 0,f=a?parseInt(a,10):void 0,m=c?parseInt(c,10):void 0,y=l?parseInt(l,10):void 0;const b=h,w=this.store.has(e);if(p&&!w)return;if(u&&w)return;let v;if(d&&w&&(v=this.store.get(e)),this.storeSet(e,t),void 0!==g||void 0!==f||void 0!==m||void 0!==y||b){let t;void 0!==g?t=Date.now()+1e3*g:void 0!==f?t=Date.now()+f:void 0!==m?t=1e3*m:void 0!==y?t=y:b&&w&&(t=this.expireTimes.get(e)),void 0!==t&&(this.expireTimes.set(e,t),this.isIndexedDBAvailable&&this.db&&this._persistExpirationToIndexedDB(e,t))}else this.expireTimes.delete(e),this.isIndexedDBAvailable&&this.db&&this._persistExpirationToIndexedDB(e,void 0);return!d||v}get(e){if(!this._checkAndRemoveExpiredKey(e))return this.store.get(e)}del(...e){let t=0;for(const s of e)this._checkAndRemoveExpiredKey(s)||this.store.delete(s)&&(this.expireTimes.delete(s),this.isIndexedDBAvailable&&this.db&&this._removeFromIndexedDB(s),t++);return t}exists(...e){let t=0;for(const s of e)this._checkAndRemoveExpiredKey(s)||this.store.has(s)&&t++;return t}incr(e){return this.incrby(e,1)}incrby(e,t){let s=this.store.get(e);if(void 0===s)s=0;else if(!Number.isInteger(Number(s)))throw new Error("ERR value is not an integer");const r=Number(s)+t;return this.storeSet(e,r.toString()),r}decr(e){try{return this.decrby(e,1)}catch(e){throw e}}decrby(e,t){let s=this.store.get(e);if(void 0===s)s=0;else if(!Number.isInteger(Number(s)))throw new Error("ERR value is not an integer");const r=Number(s)-t;return this.storeSet(e,r.toString()),r}expire(e,t,s={}){if(!this.store.has(e))return 0;const{NX:r=!1,XX:n=!1,GT:i=!1,LT:o=!1}=s,a=Date.now(),c=this.expireTimes.get(e);return r&&void 0!==c||n&&void 0===c||i&&(void 0===c||c<=a+1e3*t)||o&&(void 0===c||c>=a+1e3*t)?0:(this.expireTimes.set(e,a+1e3*t),1)}keys(e){const t=[];for(const[s,r]of this.store.entries())if(n(s,e)){const e=this.expireTimes.get(s);(void 0===e||e>Date.now())&&t.push(s)}return t}mget(...e){return e.map(e=>this.get(e))}mset(...e){if(e.length%2!=0)throw new Error("MSET requires an even number of arguments");for(let t=0;t<e.length;t+=2)this.set(e[t],e[t+1]);return!0}renamenx(e,t){if(!this.store.has(e)||this.store.has(t))return 0;const s=this.store.get(e);if(this.store.delete(e),this.storeSet(t,s),this.expireTimes.has(e)){const s=this.expireTimes.get(e);this.expireTimes.delete(e),this.expireTimes.set(t,s)}return 1}randomkey(){const e=Array.from(this.store.keys());if(0!==e.length)return e[Math.floor(Math.random()*e.length)]}expireat(e,t,s={}){if("number"!=typeof t||isNaN(t))throw new Error("ERR invalid expire time in SETEX");if(!this.store.has(e))return 0;const{NX:r=!1,XX:n=!1,GT:i=!1,LT:o=!1}=s,a=1e3*t-Date.now();if(a<=0)return this.store.delete(e),this.expireTimes.delete(e),0;const c=this.pttl(e);return n&&-1===c||r&&-1!==c||i&&-1!==c&&a<=c||o&&-1!==c&&a>=c?0:this.pexpire(e,a)}pexpire(e,t,s={}){const{NX:r=!1,XX:n=!1,GT:i=!1,LT:o=!1}=s;if(r&&this.store.has(e)||n&&!this.store.has(e))return 0;if(i||o){const s=this.pttl(e);if(i&&s>=t||o&&s<=t)return 0}return this.expireTimes.set(e,Date.now()+t),1}pexpireat(e,t){const s=t-Date.now();return s<=0?(this.store.delete(e),this.expireTimes.delete(e),0):this.pexpire(e,s)}pttl(e){if(!this.store.has(e))return-2;if(!this.expireTimes.has(e))return-1;const t=this.expireTimes.get(e)-Date.now();return t>0?t:-2}ttl(e){if(!this.store.has(e))return-2;if(!this.expireTimes.has(e))return-1;const t=Math.floor((this.expireTimes.get(e)-Date.now())/1e3);return t>0?t:-2}persist(e){return this.store.has(e)&&this.expireTimes.has(e)?(this.expireTimes.delete(e),this.isIndexedDBAvailable&&this.db&&this._persistExpirationToIndexedDB(e,void 0),1):0}getrange(e,t,s){const r=this.get(e);return"string"!=typeof r?"":r.slice(t,s+1)}getset(e,t){const s=this.get(e);return this.set(e,t),s}setex(e,t,s){if(this.store.has(e))return this.set(e,t),this.expire(e,s),!0}setrange(e,t,s){if("number"!=typeof t||t<0)throw new Error("Invalid offset value");if("string"!=typeof s)throw new Error("Value must be a string");let r=this.get(e);void 0!==r&&void 0!==r||(r="");const n=r.slice(0,t)+s+r.slice(t+s.length);return this.set(e,n),n.length}strlen(e){const t=this.get(e);return void 0===t?0:t.length}msetnx(...e){if(e.length%2!=0)throw new Error("MSETNX requires an even number of arguments");for(let t=0;t<e.length;t+=2)if(this.store.has(e[t]))return 0;for(let t=0;t<e.length;t+=2)this.set(e[t],e[t+1]);return 1}incrbyfloat(e,t){let s=this.store.get(e);if(void 0===s)s=0;else if(isNaN(parseFloat(s)))throw new Error("ERR value is not a valid float");const r=parseFloat(s)+t;return this.storeSet(e,r.toString()),r}append(e,t){const s=this.get(e),r=void 0===s?t:s+t;return this.set(e,r),r.length}getbit(e,t){const s=this.get(e);if(void 0===s||t>=8*s.length)return 0;const r=Math.floor(t/8),n=7-t%8;return s.charCodeAt(r)>>n&1}setbit(e,t,s){if(0!==s&&1!==s)throw new Error("ERR bit is not an integer or out of range");let r=this.get(e);void 0===r&&(r="");const n=Math.floor(t/8),i=7-t%8;for(;n>=r.length;)r+="\0";const o=r.charCodeAt(n),a=o>>i&1,c=o&~(1<<i)|s<<i,l=String.fromCharCode(c),h=r.slice(0,n)+l+r.slice(n+1);return this.set(e,h),a}copy(e,t){const s=this.get(e);return void 0===s?0:(this.set(t,s),1)}rename(e,t){if(!this.store.has(e))throw new Error("ERR no such key");if(e===t)return!0;const s=this.store.get(e),r=this.expireTimes.get(e);return this.storeSet(t,s),this.store.delete(e),void 0!==r&&(this.expireTimes.set(t,r),this.expireTimes.delete(e)),!0}type(e){return this.store.has(e)?typeof this.store.get(e):"none"}sadd(e,...t){this.store.has(e)||this.storeSet(e,new Set);const s=this.store.get(e);if(!(s instanceof Set))throw new Error("ERR Operation against a key holding the wrong kind of value");let r=0;for(const e of t)s.has(e)||(s.add(e),r++);return r}scard(e){const t=this.store.get(e);if(void 0===t)return 0;if(!(t instanceof Set))throw new Error("ERR Operation against a key holding the wrong kind of value");return t.size}sdiff(e,...t){const s=this.store.get(e)||new Set;if(!(s instanceof Set))throw new Error("ERR Operation against a key holding the wrong kind of value");const r=new Set(s);for(const e of t){const t=this.store.get(e)||new Set;if(!(t instanceof Set))throw new Error("ERR Operation against a key holding the wrong kind of value");for(const e of t)r.delete(e)}return Array.from(r)}sdiffstore(e,t,...s){const r=this.sdiff(t,...s),n=new Set(r);return this.storeSet(e,n),n.size}sinter(...e){if(0===e.length)return[];const t=e.map(e=>{const t=this.store.get(e);if(void 0===t)return new Set;if(!(t instanceof Set))throw new Error("ERR Operation against a key holding the wrong kind of value");return t}),s=new Set(t[0]);for(let e=1;e<t.length;e++)for(const r of s)t[e].has(r)||s.delete(r);return Array.from(s)}sintercard(...e){return this.sinter(...e).length}sinterstore(e,...t){const s=this.sinter(...t),r=new Set(s);return this.storeSet(e,r),r.size}sismember(e,t){const s=this.store.get(e);if(void 0===s)return!1;if(!(s instanceof Set))throw new Error("ERR Operation against a key holding the wrong kind of value");return!!s.has(t)}smembers(e){const t=this.store.get(e);if(void 0===t)return[];if(!(t instanceof Set))throw new Error("ERR Operation against a key holding the wrong kind of value");return Array.from(t)}smismember(e,...t){const s=this.store.get(e)||new Set;if(!(s instanceof Set))throw new Error("ERR Operation against a key holding the wrong kind of value");return t.map(e=>s.has(e)?1:0)}smove(e,t,s){const r=this.store.get(e);if(void 0===r||!r.has(s))return 0;if(!(r instanceof Set))throw new Error("ERR Operation against a key holding the wrong kind of value");const n=this.store.get(t)||new Set;if(!(n instanceof Set))throw new Error("ERR Operation against a key holding the wrong kind of value");return r.delete(s),n.add(s),this.storeSet(t,n),1}spop(e,t=1){const s=this.store.get(e);if(void 0===s)return[];if(!(s instanceof Set))throw new Error("ERR Operation against a key holding the wrong kind of value");const r=[];for(const e of s){if(r.length>=t)break;r.push(e),s.delete(e)}return r}srandmember(e,t=1){const s=this.store.get(e);if(void 0===s)return[];if(!(s instanceof Set))throw new Error("ERR Operation against a key holding the wrong kind of value");const r=Array.from(s),n=[];for(let e=0;e<t&&e<r.length;e++){const e=Math.floor(Math.random()*r.length);n.push(r[e]),r.splice(e,1)}return n}srem(e,...t){const s=this.store.get(e);if(void 0===s)return 0;if(!(s instanceof Set))throw new Error("ERR Operation against a key holding the wrong kind of value");let r=0;for(const e of t)s.delete(e)&&r++;return r}sscan(e,t,s={}){const{match:r="*",count:n=10}=s,i=this.store.get(e);if(void 0===i)return[0,[]];if(!(i instanceof Set))throw new Error("ERR Operation against a key holding the wrong kind of value");const o=new RegExp(r.replace("*",".*")),a=Array.from(i),c=[];let l=t;for(let e=t;e<a.length&&c.length<n;e++)o.test(a[e])&&c.push(a[e]),l=e+1;return[l>=a.length?0:l,c]}sunion(...e){const t=new Set;for(const s of e){const e=this.store.get(s)||new Set;if(!(e instanceof Set))throw new Error("ERR Operation against a key holding the wrong kind of value");for(const s of e)t.add(s)}return Array.from(t)}sunionstore(e,...t){const s=new Set;for(const e of t){const t=this.store.get(e)||new Set;if(!(t instanceof Set))throw new Error("ERR Operation against a key holding the wrong kind of value");for(const e of t)s.add(e)}return this.storeSet(e,s),s.size}lset(e,t,s){const r=this.store.get(e);if(void 0===r)throw new Error("ERR no such key");if(!Array.isArray(r))throw new Error("ERR Operation against a key holding the wrong kind of value");if(t<0||t>=r.length)throw new Error("ERR index out of range");return r[t]=s,!0}ltrim(e,t,s){const r=this.store.get(e);if(void 0===r)return!0;if(!Array.isArray(r))throw new Error("ERR Operation against a key holding the wrong kind of value");const n=r.length,i=t>=0?t:Math.max(n+t,0),o=s>=0?s:Math.max(n+s,-1),a=r.slice(i,o+1);return this.storeSet(e,a),!0}rpop(e){const t=this.store.get(e);return void 0!==t&&Array.isArray(t)?t.pop():null}rpoplpush(e,t){const s=this.rpop(e);return void 0===s?null:(this.lpush(t,s),s)}rpush(e,...t){let s=this.store.get(e);if(void 0===s)s=[],this.storeSet(e,s);else if(!Array.isArray(s))throw new Error("ERR Operation against a key holding the wrong kind of value");return s.push(...t),s.length}rpushx(e,t){const s=this.store.get(e);return void 0!==s&&Array.isArray(s)?(s.push(t),s.length):0}lpush(e,...t){let s=this.store.get(e);if(void 0===s)s=[],this.storeSet(e,s);else if(!Array.isArray(s))throw new Error("ERR Operation against a key holding the wrong kind of value");return s.unshift(...t),s.length}lpushx(e,...t){const s=this.store.get(e);return void 0!==s&&Array.isArray(s)?(s.unshift(...t),s.length):0}lrange(e,t,s){const r=this.store.get(e);if(void 0===r||!Array.isArray(r))return[];const n=r.length,i=t>=0?t:Math.max(n+t,0),o=s>=0?s:Math.max(n+s,-1);return r.slice(i,o+1)}lrem(e,t,s){const r=this.store.get(e);if(void 0===r||!Array.isArray(r))return 0;let n=0;if(t>0)for(let e=0;e<r.length&&n<t;e++)r[e]===s&&(r.splice(e,1),n++,e--);else if(t<0)for(let e=r.length-1;e>=0&&n<-t;e--)r[e]===s&&(r.splice(e,1),n++);else n=r.filter(e=>e===s).length,this.storeSet(e,r.filter(e=>e!==s));return n}lmove(e,t,s,r){const n="LEFT"===r?"lpush":"rpush",i=this["LEFT"===s?"lpop":"rpop"](e);return void 0===i?null:(this[n](t,i),i)}lmpop(e,t,s){const r="LEFT"===s?"lpop":"rpop",n=[];for(let s=0;s<e;s++){const e=this[r](t);if(void 0===e)break;n.push(e)}return n}lpop(e){const t=this.store.get(e);return void 0!==t&&Array.isArray(t)?t.shift():null}lpos(e,t,s={}){const{rank:r=0,start:n=0,stop:i=-1}=s,o=this.store.get(e);if(void 0===o||!Array.isArray(o))return;let a=0;const c=o.length,l=n>=0?n:Math.max(c+n,0),h=i>=0?i:Math.max(c+i,-1);for(let e=l;e<=h;e++)if(o[e]===t){if(a===r)return e;a++}}brpoplpush(e,t,s){const r=this.brpop(e,s);return void 0===r?null:(this.lpush(t,r),r)}lindex(e,t){const s=this.store.get(e);return void 0!==s&&Array.isArray(s)?(t<0&&(t=s.length+t),void 0!==s[t]?s[t]:null):null}linsert(e,t,s,r){const n=this.store.get(e);if(void 0===n)return 0;if(!Array.isArray(n))throw new Error("ERR Operation against a key holding the wrong kind of value");const i=n.indexOf(s);if(-1===i)return 0;if("BEFORE"===t)n.splice(i,0,r);else{if("AFTER"!==t)throw new Error("ERR syntax error");n.splice(i+1,0,r)}return n.length}llen(e){const t=this.store.get(e);return void 0===t?0:t.length}blmove(e,t,s,r,n){const i="LEFT"===r?"lpush":"rpush",o=this["LEFT"===s?"blpop":"brpop"]([e],n);return void 0===o?null:(this[i](t,o[1]),o[1])}blmpop(e,t,...s){const r=[],n=1e3*t,i=1===s.length?"brpop":"brpoplpush",o=s.concat(n);for(let t=0;t<e;t++){const e=this[i](o);if(void 0===e)break;r.push(e)}return r}blpop(e,...t){return this.blmpop(1,e,...t)[0]}brpop(e,...t){const s=1e3*e,r=Date.now()+s;for(;Date.now()<r;)for(let e=0;e<t.length;e++){const s=t[e],r=this.store.get(s);if(void 0!==r&&Array.isArray(r)&&r.length>0){const e=r.pop();return 0===r.length&&this.store.delete(s),[s,e]}}return null}expiretime(e){return this.expireTimes.get(e)}pexpiretime(e){const t=this.expireTimes.get(e);return t?1e3*t:null}zadd(e,t,s){return this._checkAndRemoveExpiredKey(e)?0:(this.store.has(e)||this.storeSet(e,new r),this.store.get(e).set(s,Number(t)),1)}zcard(e){return this._checkAndRemoveExpiredKey(e)?0:this.store.has(e)?this.store.get(e).size:0}zcount(e,t,s){if(this._checkAndRemoveExpiredKey(e))return 0;if(!this.store.has(e))return 0;const r=this.store.get(e);let n=0;for(const e of r.values())e>=t&&e<=s&&n++;return n}zdiff(...e){if(0===e.length)return new Set;const t=e.map(e=>this._checkAndRemoveExpiredKey(e)?new r:this.store.get(e)||new r),s=new Set(t[0].keys());for(let e=1;e<t.length;e++)for(const r of t[e].keys())s.delete(r);return s}zdiffstore(e,...t){const s=this.ZDIFF(...t),n=new r;for(const e of s){const s=t.map(t=>{const s=this.store.get(t);return s?s.get(e):void 0}).filter(e=>void 0!==e);s.length>0&&n.set(e,Math.min(...s))}return this.storeSet(e,n),n.size}bzmpop(e,...t){const s=[];for(const r of t){const t=this.store.get(r);if(t&&t.size>0){const n=Array.from(t.entries()).sort((e,t)=>e[1]-t[1]).slice(0,e).map(([e,s])=>(t.delete(e),[e,s]));s.push([r,...n]);break}}return s}bzpopmax(e,t){const s=this.store.get(e);if(!s||0===s.size)return[];const r=Array.from(s.entries()).sort((e,t)=>t[1]-e[1]).slice(0,t).map(([e,t])=>(s.delete(e),[e,t]));return[e,...r]}bzpopmin(e,t){const s=this.store.get(e);if(!s||0===s.size)return[];const r=Array.from(s.entries()).sort((e,t)=>e[1]-t[1]).slice(0,t).map(([e,t])=>(s.delete(e),[e,t]));return[e,...r]}zincrby(e,t,s){this.store.has(e)||this.storeSet(e,new r);const n=this.store.get(e),i=(n.get(s)||0)+Number(t);return n.set(s,i),i}zinter(...e){if(0===e.length)return new Set;const t=e.map(e=>this.store.get(e)||new r),s=new Set(t[0].keys());for(let e=1;e<t.length;e++){const r=new Set;for(const n of t[e].keys())s.has(n)&&r.add(n);s.clear();for(const e of r)s.add(e)}return s}zintercard(...e){return this.ZINTER(...e).size}zinterstore(e,...t){const s=this.ZINTER(...t),n=new r;for(const e of s){const s=t.map(t=>{const s=this.store.get(t);return s?s.get(e):void 0}).filter(e=>void 0!==e);s.length>0&&n.set(e,Math.max(...s))}return this.storeSet(e,n),n.size}zlexcount(e,t,s){const n=this.store.get(e)||new r,i=Array.from(n.keys()).sort();let o=0;for(const e of i)e>=t&&e<=s&&o++;return o}zmpop(e,...t){const s=[];for(const r of t){const t=this.store.get(r);if(t&&t.size>0){const n=Array.from(t.entries()).sort((e,t)=>e[1]-t[1]).slice(0,e).map(([e,s])=>(t.delete(e),[e,s]));s.push([r,...n]);break}}return s}zmscore(e,...t){const s=this.store.get(e)||new r;return t.map(e=>s.get(e))}zpopmax(e,t){const s=this.store.get(e);if(!s||0===s.size)return[];const r=Array.from(s.entries()).sort((e,t)=>t[1]-e[1]).slice(0,t).map(([e,t])=>(s.delete(e),[e,t]));return r}zpopmin(e,t){const s=this.store.get(e);if(!s||0===s.size)return[];const r=Array.from(s.entries()).sort((e,t)=>e[1]-t[1]).slice(0,t).map(([e,t])=>(s.delete(e),[e,t]));return r}zrandmember(e,t=1){const s=this.store.get(e);if(!s||0===s.size)return[];const r=Array.from(s.keys()),n=[];for(let e=0;e<t;e++){const e=Math.floor(Math.random()*r.length);n.push(r[e])}return n}zrange(e,t,s){const n=this.store.get(e)||new r,i=Array.from(n.entries()).sort((e,t)=>e[1]-t[1]);return t<0&&(t=i.length+t),s<0&&(s=i.length+s),i.slice(t,s+1).map(([e,t])=>[e,t])}zrangebylex(e,t,s,n={}){const i=this.store.get(e)||new r;let o=Array.from(i.keys()).sort().filter(e=>e>=t&&e<=s);if(n.limit){const{offset:e,count:t}=n.limit;o=o.slice(e,e+t)}return o}zrangebyscore(e,t,s,n={}){const i=this.store.get(e)||new r,o=Array.from(i.entries()).sort((e,t)=>e[1]-t[1]);let a=o.filter(([,e])=>e>=t&&e<=s);if(a=n.withscores?a.map(([e,t])=>[e,t]):a.map(([e])=>e),n.limit){const{offset:e,count:t}=n.limit;a=a.slice(e,e+t)}return a}zrangestore(e,t,s,n){const i=this.store.get(t)||new r,o=Array.from(i.entries()).sort((e,t)=>e[1]-t[1]);s<0&&(s=o.length+s),n<0&&(n=o.length+n);const a=new r(o.slice(s,n+1));return this.storeSet(e,a),a.size}zrank(e,t){const s=this.store.get(e);if(!s)return;const r=Array.from(s.entries()).sort((e,t)=>e[1]-t[1]);for(let e=0;e<r.length;e++)if(r[e][0]===t)return e}zrem(e,...t){const s=this.store.get(e);if(!s)return 0;let r=0;for(const e of t)s.delete(e)&&r++;return r}zremrangebylex(e,t,s){const r=this.store.get(e);if(!r)return 0;const n=Array.from(r.keys()).sort();let i=0;for(const e of n)e>=t&&e<=s&&(r.delete(e),i++);return i}zremrangebyrank(e,t,s){const r=this.store.get(e);if(!r)return 0;const n=Array.from(r.entries()).sort((e,t)=>e[1]-t[1]);t<0&&(t=n.length+t),s<0&&(s=n.length+s);let i=0;for(let e=t;e<=s;e++)r.delete(n[e][0])&&i++;return i}zremrangebyscore(e,t,s){const r=this.store.get(e);if(!r)return 0;const n=Array.from(r.entries()).sort((e,t)=>e[1]-t[1]);let i=0;for(const[e,o]of n)o>=t&&o<=s&&(r.delete(e),i++);return i}zrevrange(e,t,s){const n=this.store.get(e)||new r,i=Array.from(n.entries()).sort((e,t)=>t[1]-e[1]);return t<0&&(t=i.length+t),s<0&&(s=i.length+s),i.slice(t,s+1).map(([e,t])=>[e,t])}zrevrangebylex(e,t,s,n={}){const i=this.store.get(e)||new r;let o=Array.from(i.keys()).sort().reverse().filter(e=>e>=s&&e<=t);if(n.limit){const{offset:e,count:t}=n.limit;o=o.slice(e,e+t)}return o}zrevrangebyscore(e,t,s,n={}){const i=this.store.get(e)||new r,o=Array.from(i.entries()).sort((e,t)=>t[1]-e[1]);let a=o.filter(([,e])=>e>=s&&e<=t);if(a=n.withscores?a.map(([e,t])=>[e,t]):a.map(([e])=>e),n.limit){const{offset:e,count:t}=n.limit;a=a.slice(e,e+t)}return a}zrevrank(e,t){const s=this.store.get(e);if(!s)return;const r=Array.from(s.entries()).sort((e,t)=>t[1]-e[1]);for(let e=0;e<r.length;e++)if(r[e][0]===t)return e}zscan(e,t,s={}){const n=this.store.get(e)||new r,i=Array.from(n.entries()).sort((e,t)=>e[1]-t[1]),o=[];let a=s.count||10,c=t;for(;a>0&&c<i.length;)s.match&&!new RegExp(s.match.replace("*",".*")).test(i[c][0])||(o.push(i[c]),a--),c++;return[c>=i.length?0:c,o]}zscore(e,t){const s=this.store.get(e);if(s)return s.get(t)}zunion(e){const t=new r;for(const s of e){const e=this.store.get(s);if(e)for(const[s,r]of e.entries())t.set(s,(t.get(s)||0)+r)}return Array.from(t.entries()).sort((e,t)=>e[1]-t[1])}zunionstore(e,t){const s=this.zunion(t),n=new r(s);return this.storeSet(e,n),n.size}geoadd(e,t,s,n){if("number"!=typeof t||"number"!=typeof s)throw new Error("Invalid longitude or latitude value");const i=this.store.get(e)||new r;if(!i.get(n)){const r={longitude:t,latitude:s};return i.set(n,r),this.storeSet(e,i),1}return 0}geodist(e,t,s,r="m"){const n=this.store.get(e);if(!n)return;const i=n.get(t),o=n.get(s);if(!i||!o)return;const a=this._haversineDistance(i.latitude,i.longitude,o.latitude,o.longitude);return this._convertDistance(a,r)}geohash(e,...t){const s=this.store.get(e);return s?t.map(e=>{const t=s.get(e);return t?this._encodeGeohash(t.latitude,t.longitude):null}):[]}geopos(e,...t){const s=this.store.get(e);return s?t.map(e=>{const t=s.get(e);return t?[t.latitude,t.longitude]:null}):[]}georadius(e,t,s,r,n="m"){const i=this.store.get(e);if(!i)return[];const o=this._convertDistance(r,n,"m"),a=[];for(const[e,r]of i.entries())this._haversineDistance(s,t,r.latitude,r.longitude)<=o&&a.push(e);return a}georadius_ro(e,t,s,r){return this.georadius(e,t,s,r,!0)}georadiusbymember(e,t,s){const r=this.geopos(e,t);if(r)return this.georadius(r[0],r[1],s,e)}georadiusbymember_ro(e,t,s){const r=this.geopos(e,t);if(r)return this.georadius(r[0],r[1],s,e,!0)}geosearch(e,t,s,r){return this.georadius(t,s,r,e)}geosearchstore(e,t,s,r,n){const i=this.georadius(s,r,n,t);return this.set(e,i),i.length}scan(e,t="*",s=10){const r=this.keys(t),n=Math.min(e+s,r.length);return[n===r.length?0:n,r.slice(e,n)]}sort(e,t="ASC",s=!1){const r=this.store.get(e);if(!Array.isArray(r))return[];const n=r.slice().sort((e,r)=>s?"ASC"===t?e.localeCompare(r):r.localeCompare(e):"ASC"===t?e-r:r-e);return n}touch(...e){return e.reduce((e,t)=>e+(this.exists(t)?1:0),0)}sort_ro(e,t="ASC",s=!1){return this.sort(e,t,s)}unlink(...e){let t=0;for(const s of e)this.del(s)&&t++;return t}hset(e,t,s){this.store.has(e)||this.storeSet(e,new r);const n=this.store.get(e),i=!n.has(t);return n.set(t,s),i?1:0}hdel(e,...t){const s=this.store.get(e);if(!s)return 0;let r=0;for(const e of t)s.delete(e)&&r++;return r}hget(e,t){const s=this.store.get(e);return s?s.get(t):void 0}hgetall(e){const t=this.store.get(e);if(!t)return{};const s={};for(const[e,r]of t)s[e]=r;return s}hincrby(e,t,s){const n=this.store.get(e)||new r,i=parseInt(n.get(t)||0,10)+s;return n.set(t,i.toString()),this.storeSet(e,n),i}hincrbyfloat(e,t,s){const n=this.store.get(e)||new r,i=parseFloat(n.get(t)||0)+s;return n.set(t,i.toString()),this.storeSet(e,n),i}hkeys(e){const t=this.store.get(e);return t?Array.from(t.keys()):[]}hlen(e){const t=this.store.get(e);return t?t.size:0}hmget(e,...t){const s=this.store.get(e)||new r;return t.map(e=>s.get(e))}hmset(e,...t){const s=this.store.get(e)||new r;for(let e=0;e<t.length;e+=2){const r=t[e],n=t[e+1];s.set(r,n)}return this.storeSet(e,s),!0}hsetnx(e,t,s){const n=this.store.get(e)||new r;return n.has(t)?0:(n.set(t,s),this.storeSet(e,n),1)}hstrlen(e,t){const s=this.store.get(e),r=s?s.get(t):null;return r?r.length:0}hvals(e){const t=this.store.get(e);return t?Array.from(t.values()):[]}hscan(e,t,s="*",n=10){const i=this.store.get(e)||new r,o=Array.from(i.keys()).filter(e=>e.includes(s)),a=Math.min(t+n,o.length);return[a===o.length?0:a,o.slice(t,a).map(e=>[e,i.get(e)])]}hexists(e,t){const s=this.store.get(e);return s&&s.has(t)?1:0}hrandfield(e,t=1){const s=this.store.get(e);if(!s)return[];const r=Array.from(s.keys()),n=[];for(let e=0;e<t;e++){const e=Math.floor(Math.random()*r.length);n.push(r[e])}return n}_checkAndRemoveExpiredKey(e){const t=this.expireTimes.get(e);return!!(t&&Date.now()>t)&&(this.store.delete(e),this.expireTimes.delete(e),this.isIndexedDBAvailable&&this.db&&this._removeFromIndexedDB(e),!0)}_initCleanupLoop(e){1===this.store.size&&(this.cleanupLoop=setInterval(()=>{if(0===this.store.size&&this.cleanupLoop)clearInterval(this.cleanupLoop);else for(const e of this.expireTimes.keys())this._checkAndRemoveExpiredKey(e)},e),"object"==typeof this.cleanupLoop&&"function"==typeof this.cleanupLoop.unref&&this.cleanupLoop.unref())}_haversineDistance(e,t,s,r){const n=e=>e*Math.PI/180,i=n(s-e),o=n(r-t),a=Math.sin(i/2)*Math.sin(i/2)+Math.cos(n(e))*Math.cos(n(s))*Math.sin(o/2)*Math.sin(o/2);return 2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))*6371e3}_convertDistance(e,t,s){const r={m:1,km:.001,mi:621371e-9,ft:3.28084};if(!r[t]||!r[s])throw new Error("Invalid distance unit");return e*r[t]/r[s]}_encodeGeohash(e,t){let s="",r=-90,n=90,i=-180,o=180,a=!0,c=0,l=0;for(;s.length<12;){if(a){const e=(i+o)/2;t>e?(l=1+(l<<1),i=e):(l<<=1,o=e)}else{const t=(r+n)/2;e>t?(l=1+(l<<1),r=t):(l<<=1,n=t)}a=!a,c<4?c++:(s+="0123456789bcdefghjkmnpqrstuvwxyz"[l],c=0,l=0)}return s}flushall(){return this.store.clear(),this.expireTimes.clear(),this.isIndexedDBAvailable&&this.db&&this._clearIndexedDB(),!0}async _clearIndexedDB(){if(this.db)try{const e=this.db.transaction(["store","expireTimes"],"readwrite"),t=e.objectStore("store"),s=e.objectStore("expireTimes");t.clear(),s.clear()}catch(e){console.warn("Failed to clear IndexedDB:",e)}}}},614:e=>{class t{#e;constructor(e=[]){this.#e=[new Map(e)]}get size(){return this.#e.reduce((e,t)=>e+t.size,0)}clear(){this.#e=[new Map]}delete(e){return this.#e.some(t=>t.delete(e))}get(e){for(const t of this.#e)if(t.has(e))return t.get(e)}has(e){return this.#e.some(t=>t.has(e))}set(e,t){let s=this.#e[0];for(const t of this.#e)if(t.has(e)){s=t;break}return!s.has(e)&&s.size>=8388608&&(this.#e.unshift(new Map),s=this.#e[0]),s.set(e,t),this}*[Symbol.iterator](){for(const e of this.#e)yield*e}*keys(){for(const e of this.#e)yield*e.keys()}*values(){for(const e of this.#e)yield*e.values()}*entries(){for(const e of this.#e)yield*e.entries()}forEach(e,t){for(const[s,r]of this)e.call(t,r,s,this)}}e.exports=t}},t={},s=function s(r){var n=t[r];if(void 0!==n)return n.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,s),i.exports}(429);const r=class{constructor(e={}){this.config={enabled:e.enabled??!1,...e}}updateConfig(e){this.config={...this.config,...e}}enable(){this.config.enabled=!0}disable(){this.config.enabled=!1}isEnabled(){return this.config.enabled}logRequest(e={}){if(!this.isEnabled())return;const{service:t="unknown",operation:s="unknown",params:r={},result:n=null,error:i=null}=e;let o="{}";if(r&&Object.keys(r).length>0)try{o=JSON.stringify(r)}catch(e){o="[Unable to serialize params]"}const a=`${t} - ${s} - [1m${o}[22m`;i?console.error(a,{error:i.message||i,result:n}):console.log(a,n)}getStats(){return{enabled:this.config.enabled,config:{...this.config}}}},n=47;function i(e){return e===n}function o(e,t,s,r){let i="",o=0,a=-1,c=0,l=0;for(let h=0;h<=e.length;++h){if(h<e.length)l=e.charCodeAt(h);else{if(r(l))break;l=n}if(r(l)){if(a===h-1||1===c);else if(2===c){if(i.length<2||2!==o||46!==i.charCodeAt(i.length-1)||46!==i.charCodeAt(i.length-2)){if(i.length>2){const e=i.lastIndexOf(s);-1===e?(i="",o=0):(i=i.slice(0,e),o=i.length-1-i.lastIndexOf(i,s)),a=h,c=0;continue}if(0!==i.length){i="",o=0,a=h,c=0;continue}}t&&(i+=i.length>0?`${s}..`:"..",o=2)}else i.length>0?i+=`${s}${e.slice(a+1,h)}`:i=e.slice(a+1,h),o=h-a-1;a=h,c=0}else 46===l&&-1!==c?++c:c=-1}return i}const a={resolve(...e){let t="",s=!1;for(let r=e.length-1;r>=-1&&!s;r--){const i=r>=0?e[r]:"/";0!==i.length&&(t=`${i}/${t}`,s=i.charCodeAt(0)===n)}return t=o(t,!s,"/",i),s?`/${t}`:t.length>0?t:"."},normalize(e){if(0===e.length)return".";const t=e.charCodeAt(0)===n,s=e.charCodeAt(e.length-1)===n;return 0===(e=o(e,!t,"/",i)).length?t?"/":s?"./":".":(s&&(e+="/"),t?`/${e}`:e)},isAbsolute:e=>e.length>0&&e.charCodeAt(0)===n,join(...e){if(0===e.length)return".";let t;for(let s=0;s<e.length;++s){const r=e[s];r.length>0&&(void 0===t?t=r:t+=`/${r}`)}return void 0===t?".":a.normalize(t)},relative(e,t){if(e===t)return"";if((e=a.resolve(e))===(t=a.resolve(t)))return"";const s=e.length,r=s-1,i=t.length-1,o=r<i?r:i;let c=-1,l=0;for(;l<o;l++){const s=e.charCodeAt(1+l);if(s!==t.charCodeAt(1+l))break;s===n&&(c=l)}if(l===o)if(i>o){if(t.charCodeAt(1+l)===n)return t.slice(1+l+1);if(0===l)return t.slice(1+l)}else r>o&&(e.charCodeAt(1+l)===n?c=l:0===l&&(c=0));let h="";for(l=1+c+1;l<=s;++l)l!==s&&e.charCodeAt(l)!==n||(h+=0===h.length?"..":"/..");return`${h}${t.slice(1+c)}`},toNamespacedPath:e=>e,dirname(e){if(0===e.length)return".";const t=e.charCodeAt(0)===n;let s=-1,r=!0;for(let t=e.length-1;t>=1;--t)if(e.charCodeAt(t)===n){if(!r){s=t;break}}else r=!1;return-1===s?t?"/":".":t&&1===s?"//":e.slice(0,s)},basename(e,t){let s=0,r=-1,i=!0;if(void 0!==t&&t.length>0&&t.length<=e.length){if(t===e)return"";let o=t.length-1,a=-1;for(let c=e.length-1;c>=0;--c){const l=e.charCodeAt(c);if(l===n){if(!i){s=c+1;break}}else-1===a&&(i=!1,a=c+1),o>=0&&(l===t.charCodeAt(o)?-1===--o&&(r=c):(o=-1,r=a))}return s===r?r=a:-1===r&&(r=e.length),e.slice(s,r)}for(let t=e.length-1;t>=0;--t)if(e.charCodeAt(t)===n){if(!i){s=t+1;break}}else-1===r&&(i=!1,r=t+1);return-1===r?"":e.slice(s,r)},extname(e){let t=-1,s=0,r=-1,i=!0,o=0;for(let a=e.length-1;a>=0;--a){const c=e.charCodeAt(a);if(c!==n)-1===r&&(i=!1,r=a+1),46===c?-1===t?t=a:1!==o&&(o=1):-1!==t&&(o=-1);else if(!i){s=a+1;break}}return-1===t||-1===r||0===o||1===o&&t===r-1&&t===s+1?"":e.slice(t,r)},format:function(e,t){validateObject(t,"pathObject");const s=t.dir||t.root,r=t.base||`${t.name||""}${t.ext||""}`;return s?s===t.root?`${s}${r}`:`${s}${e}${r}`:r}.bind(null,"/"),parse(e){const t={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return t;const s=e.charCodeAt(0)===n;let r;s?(t.root="/",r=1):r=0;let i=-1,o=0,a=-1,c=!0,l=e.length-1,h=0;for(;l>=r;--l){const t=e.charCodeAt(l);if(t!==n)-1===a&&(c=!1,a=l+1),46===t?-1===i?i=l:1!==h&&(h=1):-1!==i&&(h=-1);else if(!c){o=l+1;break}}if(-1!==a){const r=0===o&&s?1:o;-1===i||0===h||1===h&&i===a-1&&i===o+1?t.base=t.name=e.slice(r,a):(t.name=e.slice(r,i),t.base=e.slice(r,a),t.ext=e.slice(i,a))}return o>0?t.dir=e.slice(0,o-1):s&&(t.dir="/"),t},sep:"/",delimiter:":",win32:null,posix:null},c=a;var l={},h={};l.length=0,l.getItem=function(e){return e in h?h[e]:null},l.setItem=function(e,t){void 0===t?l.removeItem(e):(h.hasOwnProperty(e)||l.length++,h[e]=`${t}`)},l.removeItem=function(e){h.hasOwnProperty(e)&&(delete h[e],l.length--)},l.key=function(e){return Object.keys(h)[e]||null},l.clear=function(){h={},l.length=0},"object"==typeof exports&&(module.exports=l);const u=l,p=Symbol("readyState"),d=Symbol("headers"),g=Symbol("response headers"),f=Symbol("AbortController"),m=Symbol("method"),y=Symbol("URL"),b=Symbol("MIME"),w=Symbol("dispatch"),v=Symbol("errored"),k=Symbol("timeout"),A=Symbol("timedOut"),I=Symbol("isResponseText");function _(...e){const t=e.reduce((e,t)=>e+t.length,0),s=new Uint8Array(t);return e.forEach((e,t,r)=>{const n=r.slice(0,t).reduce((e,t)=>e+t.length,0);s.set(e,n)}),s}async function x(e){const t=this.responseType||"text",s=new TextDecoder,r=this[b]||this[g].get("content-type")||"text/plain";switch(t){case"text":this.response=s.decode(e);break;case"blob":this.response=new Blob([e],{type:r});break;case"arraybuffer":this.response=e.buffer;break;case"json":this.response=JSON.parse(s.decode(e))}}const T=class extends EventTarget{onreadystatechange(){}set readyState(e){this[p]!==e&&(this[p]=e,this.dispatchEvent(new Event("readystatechange")),this.onreadystatechange(new Event("readystatechange")))}get readyState(){return this[p]}constructor(){super(),this.readyState=this.constructor.UNSENT,this.response=null,this.responseType="",this.responseURL="",this.status=0,this.statusText="",this.timeout=0,this.withCredentials=!1,this[d]=Object.create(null),this[d].accept="*/*",this[g]=Object.create(null),this[f]=new AbortController,this[m]="",this[y]="",this[b]="",this[v]=!1,this[k]=0,this[A]=!1,this[I]=!0}static get UNSENT(){return 0}static get OPENED(){return 1}static get HEADERS_RECEIVED(){return 2}static get LOADING(){return 3}static get DONE(){return 4}upload={addEventListener(){}};get responseText(){if(this[v])return null;if(this.readyState<this.constructor.HEADERS_RECEIVED)return"";if(this[I])return this.response;throw new DOMException("Response type not set to text","InvalidStateError")}get responseXML(){throw new Error("XML not supported")}[w](e){const t=`on${e.type}`;"function"==typeof this[t]&&this.addEventListener(e.type,this[t].bind(this),{once:!0}),this.dispatchEvent(e)}abort(){this[f].abort(),this.status=0,this.readyState=this.constructor.UNSENT}open(e,t){this.status=0,this[m]=e,this[y]=t,this.readyState=this.constructor.OPENED}setRequestHeader(e,t){e=String(e).toLowerCase(),void 0===this[d][e]?this[d][e]=String(t):this[d][e]+=`, ${t}`}overrideMimeType(e){this[b]=String(e)}getAllResponseHeaders(){return this[v]||this.readyState<this.constructor.HEADERS_RECEIVED?"":Array.from(this[g].entries().map(([e,t])=>`${e}: ${t}`)).join("\r\n")}getResponseHeader(e){const t=this[g].get(String(e).toLowerCase());return"string"==typeof t?t:null}send(e=null){this.timeout>0&&(this[k]=setTimeout(()=>{this[A]=!0,this[f].abort()},this.timeout));const t=this.responseType||"text";this[I]="text"===t,this.setRequestHeader("user-agent","puter-js/1.0"),this.setRequestHeader("origin","https://puter.work"),this.setRequestHeader("referer","https://puter.work/"),fetch(this[y],{method:this[m]||"GET",signal:this[f].signal,headers:this[d],credentials:this.withCredentials?"include":"same-origin",body:e}).then(async e=>{if(this.responseURL=e.url,this.status=e.status,this.statusText=e.statusText,this[g]=e.headers,this.readyState=this.constructor.HEADERS_RECEIVED,e.headers.get("content-type").includes("application/x-ndjson")||this.streamRequestBadForPerformance){let t=new Uint8Array;for await(const s of e.body)this.readyState=this.constructor.LOADING,t=_(t,s),x.call(this,t),this[w](new CustomEvent("progress"))}else{const t=[];for await(const s of e.body)t.push(s);x.call(this,_(...t))}this.readyState=this.constructor.DONE,this[w](new CustomEvent("load"))},e=>{let t="abort";"AbortError"!==e.name?(this[v]=!0,t="error"):this[A]&&(t="timeout"),this.readyState=this.constructor.DONE,this[w](new CustomEvent(t))}).finally(()=>this[w](new CustomEvent("loadend"))).finally(()=>{clearTimeout(this[k]),this[w](new CustomEvent("loadstart"))})}};"object"==typeof module&&module.exports?module.exports=T:(globalThis||self).XMLHttpRequestShim=T;const E=T;class S{constructor(){this.result=null,this.error=null,this.onloadend=null}readAsDataURL(e){const t=this;!async function(){try{let s;s=e&&"function"==typeof e.arrayBuffer?await e.arrayBuffer():e instanceof ArrayBuffer?e:ArrayBuffer.isView(e)?e.buffer:new Uint8Array(0).buffer;const r=function(e){const t=new Uint8Array(e).reduce((e,t)=>e+String.fromCharCode(t),"");return"function"==typeof btoa?btoa(t):Buffer.from(t,"binary").toString("base64")}(s),n=e&&e.type||"application/octet-stream";t.result="data:"+n+";base64,"+r,"function"==typeof t.onloadend&&t.onloadend()}catch(e){t.error=e,"function"==typeof t.onloadend&&t.onloadend()}}()}}class C extends(globalThis.HTMLElement||Object){constructor(e){super(),this.message=e||"You have reached your usage limit for this account.",this.attachShadow({mode:"open"}),this.shadowRoot.innerHTML=`\n        <style>\n            dialog {\n                background: transparent;\n                border: none;\n                box-shadow: none;\n                outline: none;\n                padding: 0;\n                max-width: 90vw;\n            }\n            \n            dialog::backdrop {\n                background: rgba(0, 0, 0, 0.5);\n            }\n            \n            .dialog-content {\n                border: 1px solid #e8e8e8;\n                border-radius: 12px;\n                padding: 32px;\n                background: white;\n                box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);\n                -webkit-font-smoothing: antialiased;\n                color: #333;\n                position: relative;\n                max-width: 420px;\n                font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;\n            }\n            \n            .close-btn {\n                position: absolute;\n                right: 16px;\n                top: 12px;\n                font-size: 20px;\n                color: #999;\n                cursor: pointer;\n                width: 28px;\n                height: 28px;\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                border-radius: 50%;\n                transition: background 0.2s, color 0.2s;\n            }\n            \n            .close-btn:hover {\n                background: #f0f0f0;\n                color: #333;\n            }\n            \n            .icon-container {\n                width: 64px;\n                height: 64px;\n                margin: 0 auto 20px;\n                background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%);\n                border-radius: 50%;\n                display: flex;\n                align-items: center;\n                justify-content: center;\n            }\n            \n            .icon-container svg {\n                width: 32px;\n                height: 32px;\n                color: #f57c00;\n            }\n            \n            h2 {\n                margin: 0 0 12px;\n                font-size: 20px;\n                font-weight: 600;\n                text-align: center;\n                color: #1a1a1a;\n            }\n            \n            .message {\n                text-align: center;\n                font-size: 14px;\n                line-height: 1.5;\n                color: #666;\n                margin-bottom: 24px;\n            }\n            \n            .buttons {\n                display: flex;\n                gap: 12px;\n                justify-content: center;\n            }\n            \n            .button {\n                padding: 10px 24px;\n                border-radius: 8px;\n                font-size: 14px;\n                font-weight: 500;\n                cursor: pointer;\n                transition: all 0.2s;\n                border: none;\n                font-family: inherit;\n            }\n            \n            .button-secondary {\n                background: #f5f5f5;\n                color: #666;\n            }\n            \n            .button-secondary:hover {\n                background: #e8e8e8;\n            }\n            \n            .button-primary {\n                background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);\n                color: white;\n            }\n            \n            .button-primary:hover {\n                background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);\n                box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);\n            }\n        </style>\n        <dialog>\n            <div class="dialog-content">\n                <span class="close-btn">&#x2715;</span>\n                <div class="icon-container">\n                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">\n                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />\n                    </svg>\n                </div>\n                <h2>Low Balance</h2>\n                <p class="message">${this.message}</p>\n                <div class="buttons">\n                    <button class="button button-secondary" id="close-btn">Close</button>\n                    <button class="button button-primary" id="upgrade-btn">Upgrade Now</button>\n                </div>\n            </div>\n        </dialog>\n        `}connectedCallback(){const e=this.shadowRoot.querySelector("dialog");this.shadowRoot.querySelector(".close-btn").addEventListener("click",()=>{this.close()}),this.shadowRoot.querySelector("#close-btn").addEventListener("click",()=>{this.close()}),this.shadowRoot.querySelector("#upgrade-btn").addEventListener("click",()=>{window.open("https://puter.com/dashboard","_blank"),this.close()}),e.addEventListener("click",t=>{t.target===e&&this.close()})}open(){this.shadowRoot.querySelector("dialog").showModal()}close(){this.shadowRoot.querySelector("dialog").close(),this.remove()}}function P(e){if(void 0===globalThis.document)return void console.warn("[Puter]",e);if(document.querySelector("usage-limit-dialog"))return;const t=new C(e);document.body.appendChild(t),t.open()}async function D(e){if("blob"===e.responseType){const t=e.getResponseHeader("content-type");if(t.startsWith("application/json")){const t=await e.response.text();try{return JSON.parse(t)}catch(e){return t}}else if(t.startsWith("application/octet-stream"))return e.response;return{success:!0,result:e.response}}const t=e.responseText;try{return JSON.parse(t)}catch(e){return t}}void 0!==globalThis.HTMLElement&&globalThis.customElements&&(customElements.get("usage-limit-dialog")||customElements.define("usage-limit-dialog",C));const O=()=>{let e,t;return{promise:new Promise((s,r)=>{e=s,t=r}),resolve:e,reject:t}};function L(e,t,s,r="post",n="text/plain;actually=json",i=void 0){const o=new XMLHttpRequest;return o.open(r,t+e,!0),s&&o.setRequestHeader("Authorization",`Bearer ${s}`),o.setRequestHeader("Content-Type",n),o.responseType=i??"",globalThis.puter?.apiCallLogger?.isEnabled()&&(o._puterRequestId={method:r,service:"xhr",operation:e.replace(/^\